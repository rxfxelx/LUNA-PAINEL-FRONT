<!doctype html>
<html lang="pt-BR" class="dark">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Luna – Supervisor WhatsApp</title>
  <link rel="stylesheet" href="styles.css"/>
  <script defer src="config.js"></script>
  <script defer src="app.js"></script>
  <style>.hidden{display:none!important}</style>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;600;700&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>

  <!-- LOGIN -->
  <main id="login-view" class="login">
    <div class="login-card">
      <div class="login-header">
        <!-- Substituindo emoji por SVG customizado da lua mais bonito -->
        <div class="login-icon">
          <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="moonGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#84cc16;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#16a34a;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#15803d;stop-opacity:1" />
              </linearGradient>
              <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                <feMerge> 
                  <feMergeNode in="coloredBlur"/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
              <filter id="innerShadow">
                <feOffset dx="0" dy="2"/>
                <feGaussianBlur stdDeviation="2" result="offset-blur"/>
                <feFlood flood-color="#0f172a" flood-opacity="0.4"/>
                <feComposite in2="offset-blur" operator="in"/>
              </filter>
            </defs>
            <!-- Lua principal com gradiente -->
            <circle cx="40" cy="40" r="32" fill="url(#moonGradient)" filter="url(#glow)"/>
            <!-- Sombra da lua crescente -->
            <path d="M20 40C20 24.536 32.536 12 48 12C43.582 12 39.582 13.791 36.686 16.686C30.895 22.477 28 30.477 28 40C28 49.523 30.895 57.523 36.686 63.314C39.582 66.209 43.582 68 48 68C32.536 68 20 55.464 20 40Z" fill="#0f172a" opacity="0.4"/>
            <!-- Crateras da lua -->
            <circle cx="30" cy="28" r="3" fill="#15803d" opacity="0.6"/>
            <circle cx="48" cy="24" r="2" fill="#84cc16" opacity="0.8"/>
            <circle cx="52" cy="36" r="1.5" fill="#a3e635" opacity="0.7"/>
            <circle cx="34" cy="48" r="2.5" fill="#16a34a" opacity="0.5"/>
            <circle cx="46" cy="52" r="1" fill="#84cc16" opacity="0.9"/>
            <!-- Brilho sutil -->
            <circle cx="32" cy="32" r="1.5" fill="#ffffff" opacity="0.8"/>
            <circle cx="44" cy="28" r="1" fill="#ffffff" opacity="0.6"/>
          </svg>
        </div>
        <h1>Luna</h1>
        <p class="login-sub">Supervisor WhatsApp Profissional</p>
      </div>
      <div class="login-form">
        <div class="form-group">
          <label for="token">Token da Instância</label>
          <input id="token" class="inp" placeholder="Cole seu token UAZAPI aqui" />
        </div>
        <button id="btn-login" class="btn btn-primary">
          <span>Entrar no Sistema</span>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </button>
        <div id="msg" class="msg-err"></div>
      </div>
    </div>
  </main>

  <!-- LOADING -->
  <section id="loading-view" class="loading hidden">
    <div class="loading-container">
      <!-- Substituindo emoji por SVG customizado da lua no loading -->
      <div class="loading-icon">
        <svg width="96" height="96" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="moonGradientLoading" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#84cc16;stop-opacity:1" />
              <stop offset="50%" style="stop-color:#16a34a;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#15803d;stop-opacity:1" />
            </linearGradient>
            <filter id="glowLoading" x="-50%" y="-50%" width="200%" height="200%">
              <feGaussianBlur stdDeviation="5" result="coloredBlur"/>
              <feMerge> 
                <feMergeNode in="coloredBlur"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>
          <circle cx="40" cy="40" r="32" fill="url(#moonGradientLoading)" filter="url(#glowLoading)"/>
          <path d="M20 40C20 24.536 32.536 12 48 12C43.582 12 39.582 13.791 36.686 16.686C30.895 22.477 28 30.477 28 40C28 49.523 30.895 57.523 36.686 63.314C39.582 66.209 43.582 68 48 68C32.536 68 20 55.464 20 40Z" fill="#0f172a" opacity="0.4"/>
          <circle cx="30" cy="28" r="3" fill="#15803d" opacity="0.6"/>
          <circle cx="48" cy="24" r="2" fill="#84cc16" opacity="0.8"/>
          <circle cx="52" cy="36" r="1.5" fill="#a3e635" opacity="0.7"/>
          <circle cx="34" cy="48" r="2.5" fill="#16a34a" opacity="0.5"/>
          <circle cx="46" cy="52" r="1" fill="#84cc16" opacity="0.9"/>
          <circle cx="32" cy="32" r="1.5" fill="#ffffff" opacity="0.8"/>
          <circle cx="44" cy="28" r="1" fill="#ffffff" opacity="0.6"/>
        </svg>
      </div>
      <div class="loading-spinner"></div>
      <h2>Carregando Sistema</h2>
      <p>Preparando suas conversas...</p>
      <div class="loading-progress">
        <div class="progress-bar">
          <div class="progress-fill"></div>
        </div>
        <span class="progress-text">Conectando...</span>
      </div>
    </div>
  </section>

  <!-- APP -->
  <section id="app-view" class="app hidden">
    <header class="topbar">
      <div class="brand">
        <!-- Substituindo emoji por SVG customizado da lua no header -->
        <div class="brand-icon">
          <svg width="36" height="36" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="moonGradientHeader" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#84cc16;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#16a34a;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#15803d;stop-opacity:1" />
              </linearGradient>
              <filter id="glowHeader" x="-50%" y="-50%" width="200%" height="200%">
                <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                <feMerge> 
                  <feMergeNode in="coloredBlur"/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
            </defs>
            <circle cx="40" cy="40" r="32" fill="url(#moonGradientHeader)" filter="url(#glowHeader)"/>
            <path d="M20 40C20 24.536 32.536 12 48 12C43.582 12 39.582 13.791 36.686 16.686C30.895 22.477 28 30.477 28 40C28 49.523 30.895 57.523 36.686 63.314C39.582 66.209 43.582 68 48 68C32.536 68 20 55.464 20 40Z" fill="#0f172a" opacity="0.4"/>
            <circle cx="30" cy="28" r="3" fill="#15803d" opacity="0.6"/>
            <circle cx="48" cy="24" r="2" fill="#84cc16" opacity="0.8"/>
            <circle cx="52" cy="36" r="1.5" fill="#a3e635" opacity="0.7"/>
            <circle cx="32" cy="32" r="1.5" fill="#ffffff" opacity="0.8"/>
          </svg>
        </div>
        <div class="brand-text">
          <span class="brand-name">Luna</span>
          <small id="profile">Supervisor WhatsApp</small>
        </div>
      </div>
      <div class="topbar-actions">
        <button id="btn-refresh" class="btn btn-icon" title="Atualizar">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
            <path d="M21 3v5h-5"/>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
            <path d="M3 21v-5h5"/>
          </svg>
        </button>
        <button id="btn-logout" class="btn btn-secondary">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
            <polyline points="16,17 21,12 16,7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
          <span class="btn-text">Sair</span>
        </button>
      </div>
    </header>

    <div class="shell">
      <aside class="sidebar">
        <div class="sidebar-head">
          <h2>Conversas</h2>
          <!-- Adicionando seletor mobile para as abas -->
          <div class="mobile-stage-selector">
            <select id="mobile-stage-select" class="stage-select">
              <option value="geral">Geral</option>
              <option value="contatos">Contatos</option>
              <option value="lead">Lead</option>
              <option value="lead_quente">Lead Quente</option>
            </select>
          </div>
          <div class="sidebar-stats">
            <span class="stats-badge">Ativo</span>
          </div>
        </div>
        <!-- Removendo contadores mobile completamente -->
        <div id="chat-list" class="chat-list"></div>
      </aside>

      <main class="main">
        <div class="chatbar">
          <button id="btn-back-mobile" class="btn btn-icon back">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
          </button>
          <div class="chat-info">
            <div id="chat-header" class="chat-title">Selecione uma conversa</div>
            <div class="chat-status">Escolha um chat para começar</div>
          </div>
        </div>
        <div id="messages" class="messages">
          <div class="empty-state">
            <div class="empty-icon">💬</div>
            <h3>Nenhuma conversa selecionada</h3>
            <p>Escolha uma conversa da lista para visualizar as mensagens</p>
          </div>
        </div>
        <div class="send">
          <div class="send-group">
            <input id="send-number" class="inp inp-compact" placeholder="Número (55319...)" />
            <input id="send-text" class="inp inp-main" placeholder="Digite sua mensagem..." />
            <button id="btn-send" class="btn btn-primary btn-send">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
              </svg>
            </button>
          </div>
        </div>
      </main>
    </div>
  </section>

</body>
</html>
